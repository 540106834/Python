# **Python 的模块与导入（import）**
从基础到实战应用，帮你在写 Prometheus/Alertmanager、文件处理、脚本时理解模块组织和使用方式。


# **1️ 模块是什么？**

在 Python 中：

* **模块（module）** 是一个 `.py` 文件，里面可以包含：

  * 函数
  * 类
  * 变量
  * 可执行代码

**例子：创建一个模块**

文件 `mymath.py`：

```python
PI = 3.14159

def add(a, b):
    return a + b

def sub(a, b):
    return a - b
```

这里的 `mymath.py` 就是一个模块。

---

# **2️ 导入模块**

### 2.1 `import 模块名`

```python
import mymath

print(mymath.PI)
print(mymath.add(2, 3))
```

特点：

* 使用模块名作为前缀访问
* 避免命名冲突

---

### 2.2 `from 模块名 import 名称`

```python
from mymath import add, PI

print(add(5, 6))
print(PI)
```

特点：

* 直接访问函数或变量
* 名称直接暴露在当前命名空间
* 注意避免与已有名称冲突

---

### 2.3 `from 模块名 import *`（不推荐）

```python
from mymath import *

print(add(1, 2))
```

特点：

* 导入模块所有内容
* 可能覆盖当前命名空间中的已有名称
* **生产环境不推荐使用**

---

### 2.4 给模块或函数起别名

```python
import mymath as mm
from mymath import add as plus

print(mm.PI)
print(plus(2, 3))
```

---

# **3️ 包（package）**

* **包** 是一个目录，里面有 `__init__.py` 文件
* 可以包含多个模块
* 用于模块的组织和分层

**结构示例：**

```
mypkg/
    __init__.py
    math_ops.py
    string_ops.py
```

导入：

```python
from mypkg import math_ops
from mypkg.string_ops import to_upper
```

---

# **4️ 模块搜索路径**

Python 导入模块时，会按照 **sys.path** 查找：

```python
import sys
print(sys.path)
```

顺序：

1. 当前目录
2. 环境变量 `PYTHONPATH`
3. Python 自带库
4. 第三方库（如 site-packages）

---

# **5️ 常见场景**

### 5.1 复用函数库

```python
# utils.py
def load_json(path):
    import json
    with open(path, "r", encoding="utf-8") as f:
        return json.load(f)
```

```python
# main.py
from utils import load_json

data = load_json("config.json")
```

### 5.2 分层管理大项目

```
project/
    main.py
    prometheus/
        __init__.py
        scrape.py
        rules.py
```

```python
from prometheus.scrape import scrape_target
```

### 5.3 第三方库

```python
import requests
import json
```

结合模块管理，整个项目会更加清晰。

---

# **6️ 动态导入**

```python
module_name = "math"
math_module = __import__(module_name)
print(math_module.sqrt(16))
```

* 用于根据条件动态选择模块
* 进阶用法，少用

---

# **7️ 小结**

* **模块 = .py 文件**，封装函数/类/变量
* **包 = 文件夹 + **init**.py**，组织模块
* 导入方式：

  * `import module`
  * `from module import name`
  * `import module as alias`
* 模块管理让大型项目可维护、可复用
* 常用在：

  * Prometheus/Alertmanager 项目分层
  * 工具函数复用
  * 第三方库引用

