
# 文件操作是 Python 的核心技能之一，特别是在运维、日志处理、配置文件（JSON / YAML）中用得非常多。
下面我给你一个**系统讲解 + 实战示例**（你可以直接在 VSCode 里运行）。

---

##  一、读取 / 写入普通文本（日志文件）

###  1. 写入日志

```python
# 写入日志文件
with open("app.log", "w", encoding="utf-8") as f:
    f.write("服务启动成功\n")
    f.write("端口监听中...\n")
```

> `"w"` 模式：覆盖写入
> `"a"` 模式：追加写入（不会清空原内容）

---

###  2. 读取日志

```python
# 读取日志文件
with open("app.log", "r", encoding="utf-8") as f:
    for line in f:
        print(line.strip())
```

 输出示例：

```
服务启动成功
端口监听中...
```

---

##  二、JSON 文件操作（常用于配置或接口）

Python 内置 `json` 模块，非常方便。

###  1. 写入 JSON

```python
import json

data = {
    "service": "web",
    "status": "running",
    "port": 80
}

with open("config.json", "w", encoding="utf-8") as f:
    json.dump(data, f, ensure_ascii=False, indent=4)
```

 输出文件（`config.json`）：

```json
{
    "service": "web",
    "status": "running",
    "port": 80
}
```

---

###  2. 读取 JSON

```python
import json

with open("config.json", "r", encoding="utf-8") as f:
    config = json.load(f)

print(config["service"])
```

 输出：

```
web
```

---

##  三、YAML 文件操作（常用于 K8s / Prometheus 配置）

> YAML 是配置文件常用格式，比 JSON 更简洁。
> 需要安装 PyYAML 模块：

```bash
pip install pyyaml
```

---

###  1. 写入 YAML

```python
import yaml

data = {
    "service": "prometheus",
    "port": 9090,
    "scrape_interval": "15s"
}

with open("config.yaml", "w", encoding="utf-8") as f:
    yaml.dump(data, f, allow_unicode=True)
```

 输出（`config.yaml`）：

```yaml
service: prometheus
port: 9090
scrape_interval: 15s
```

---

###  2. 读取 YAML

```python
import yaml

with open("config.yaml", "r", encoding="utf-8") as f:
    config = yaml.safe_load(f)

print(config["service"])
```

 输出：

```
prometheus
```

---

##  四、综合示例：日志 + JSON + YAML

```python
import json, yaml, time

# 写入日志
with open("monitor.log", "a", encoding="utf-8") as log:
    log.write(f"[{time.strftime('%H:%M:%S')}] 服务运行中...\n")

# 写入 JSON 配置
config = {"interval": 5, "targets": ["node1", "node2"]}
with open("targets.json", "w", encoding="utf-8") as f:
    json.dump(config, f, indent=4, ensure_ascii=False)

# 写入 YAML 配置
with open("targets.yaml", "w", encoding="utf-8") as f:
    yaml.dump(config, f, allow_unicode=True)

# 读取 YAML
with open("targets.yaml", "r", encoding="utf-8") as f:
    data = yaml.safe_load(f)
    print("监控目标：", data["targets"])
```

 输出：

```
监控目标： ['node1', 'node2']
```

---

##  五、总结对比

| 格式      | 常见用途         | 模块          | 优点        |
| ------- | ------------ | ----------- | --------- |
| `.log`  | 普通日志         | 内置 `open()` | 简单直观      |
| `.json` | API / 配置     | 内置 `json`   | 标准格式，跨语言  |
| `.yaml` | DevOps / K8s | `pyyaml`    | 可读性强，支持注释 |

---

是否希望我帮你扩展一个**自动生成监控配置（YAML + JSON）+ 日志记录**的小脚本？
比如读取一个服务列表，然后输出 Prometheus scrape 配置。
