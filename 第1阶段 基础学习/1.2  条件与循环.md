太棒了 💪 我们进入 **阶段 1 - 第 2 节：条件语句与循环结构（SRE 实战版）**

---

## 🧩 第 2 节：条件语句与循环结构（if / for / while）

在 SRE 监控脚本中，**条件语句** 用于判断系统状态是否异常，
**循环结构** 用于批量检测、轮询监控目标。

---

### 🎯 实战目标

> 写一个小脚本：
> 检查多个服务的“健康检查结果”，
> 输出哪些服务异常，哪些正常。

---

## 🧠 1. 条件语句基础

```python
status = 503

if status == 200:
    print("✅ 服务正常")
elif status == 404:
    print("❌ 服务不存在")
else:
    print("⚠️ 服务异常")
```

📘 在监控中常用于判断 HTTP 状态码、进程返回值、指标阈值。

---

## 🔁 2. 循环结构基础

循环常用于批量检测多个主机或服务：

```python
services = ["auth", "payment", "monitoring"]

for name in services:
    print(f"检查服务: {name}")
```

也可以配合条件语句：

```python
results = {
    "auth": 200,
    "payment": 503,
    "monitoring": 200
}

for svc, status in results.items():
    if status == 200:
        print(f"{svc}: ✅ 正常")
    else:
        print(f"{svc}: ⚠️ 异常 (status={status})")
```

🧾 **输出结果：**

```
auth: ✅ 正常
payment: ⚠️ 异常 (status=503)
monitoring: ✅ 正常
```

---

## ⏳ 3. while 循环（简单轮询监控示例）

```python
import time

count = 0

while count < 3:
    print(f"第 {count+1} 次检查服务健康状态...")
    # 模拟每 5 秒检查一次
    time.sleep(5)
    count += 1

print("检测结束。")
```

💡 实际中可以结合 HTTP 请求或 ping 检查，构成「定时轮询监控」逻辑。

---

## 🧩 小练习（动手）

请你写一个脚本，模拟以下逻辑：

> 有三个服务：`auth`, `payment`, `monitoring`
> 他们的 HTTP 状态码分别为 `[200, 503, 200]`
> 程序逐个检测并打印：
>
> * 200 → “✅ 正常”
> * 503 → “⚠️ 异常，请检查服务！”

---

要我帮你：
A. 给出练习答案 + 讲解
B. 继续进入下一节（函数与模块 — 构建可复用监控函数）


太好了 👍 我们来完成这道练习，并讲解背后的 SRE 实战逻辑。

---

## 🧩 练习题：检测多个服务健康状态

**题目回顾：**
有三个服务：`auth`, `payment`, `monitoring`
HTTP 状态码依次为 `[200, 503, 200]`
程序逐个检测并打印：

* `200 → ✅ 正常`
* `503 → ⚠️ 异常，请检查服务！`

---

### ✅ 参考答案

```python
# 服务名称与对应状态码
services = ["auth", "payment", "monitoring"]
status_codes = [200, 503, 200]

# 遍历检测
for name, code in zip(services, status_codes):
    if code == 200:
        print(f"{name}: ✅ 正常")
    else:
        print(f"{name}: ⚠️ 异常，请检查服务！（status={code}）")
```

---

### 💡 输出结果

```
auth: ✅ 正常
payment: ⚠️ 异常，请检查服务！（status=503）
monitoring: ✅ 正常
```

---

### 🧠 知识点讲解

| 知识点         | 含义        | 实战意义              |
| ----------- | --------- | ----------------- |
| `zip()`     | 将两个列表配对遍历 | 常用于「服务名 + 状态」配对检测 |
| `if / else` | 条件判断      | 判断服务是否健康          |
| `f"..."`    | 格式化输出     | 更清晰展示监控信息         |

---

### 🔧 进阶：更真实的监控版本（带时间与轮询）

```python
import time

services = ["auth", "payment", "monitoring"]
status_codes = [200, 503, 200]

for i in range(3):  # 轮询3次
    print(f"\n第 {i+1} 次巡检 ({time.strftime('%H:%M:%S')}):")
    for name, code in zip(services, status_codes):
        if code == 200:
            print(f"✅ {name} 正常")
        else:
            print(f"⚠️ {name} 异常，请检查服务！（status={code}）")
    time.sleep(5)  # 每5秒检测一次
```

📈 这个版本就是 SRE 巡检脚本的雏形。
你可以后续将 `status_codes` 替换为：

* Prometheus HTTP API 查询结果；
* 实际的 `requests.get(url).status_code`；
* 或 Kubernetes Pod 状态信息。

---

是否继续进入下一节 👉
**「阶段 1 - 函数与模块（构建可复用监控函数）」**？
